<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8" />
  <title>בחינה</title>
  <link rel="stylesheet" href="script.css">
</head>
<body>
  <div id="intro">
    <h1>הוראות הבחינה</h1>
    <p>היי! הניסוי נועד לבדוק השפעות של דדליין גלוי על ביצועים במשימות. כל הניסוי יערוך 10-15 דקות בערך.
הניסוי כולל שתי בחינות שכוללות 60 תרגילים כל אחת שאמורים להיות ברמה של כיתה ג בחשבון. כל בחינה תיקח 5 דקות בדיוק. אשמח אם תבצעו את שתי הבחינות אחת אחרי השנייה. 
אמורים לפתור אותן באמצעות דף ועיפרון בלבד, ללא מחשבון.
תודה רבה על העזרה!
תמר
</p>
<div class="input-row">
  <label for="nameInput">שם הנבחנ/ת:</label>
  <input type="text" id="nameInput" />
</div><br /><br />
    <button onclick="startTest()">התחל</button>
  </div>

  <div id="test" class="hidden">
    <div class="timer" id="timer"></div>
    <form id="testForm"></form>
    <div class="center">
      <button onclick="submitTest(event)">סיים מבחן</button>
    </div>
  </div>

  <div id="between" class="hidden">
    <h2>המבחן הסתיים</h2>
    <button onclick="startSecondTest()">המשך לבחינה השנייה</button>
  </div>

  <div id="done" class="hidden">
  <h2>תודה רבה!</h2>
  <p>
    הקובץ עם תוצאות המבחן ירד למחשב שלך. <br />
    נא לשלוח אותו לכתובת: 
 <strong>tamarnnn@gmail.com</strong><br />
    ניתן לשלוח אותו במייל תחת הכותרת: "תוצאות מבחן" או פשוט לצרף כקובץ.<br /><br />
    תודה רבה על ההשתתפות!
  </p>
  <button onclick="downloadResults()">הורד קובץ תוצאות</button>
</div>



  <script>
const questions1 = [
  "4+3", "13-6", "7*2", "9:3", "11*2-3", "18:3+5", "16-10:5", "6*3+2",
  "14-2*4", "20:5+1", "5+9", "17-8", "8*2", "15:3", "9+4-2", "6+2*3",
  "12-3+5", "4*3-2", "21:7+6", "18-6:3", "8+5", "14-9", "6*2", "12:4",
  "7+3*2", "16-2*5", "5*3+1", "20:2-4", "9+7", "18-10",
  "3+3", "8*2", "6*4-5", "16:4+7", "19-3+2", "6*2+3", "15:5-1", "10+2*2",
  "17-8+4", "12-2*3", "5+4", "11-7", "7*3", "21:7", "8+6-1", "13-5+3",
  "6*2+4", "16:2-3", "9+1*3", "18-6+2", "4+6", "14-8", "3*3", "9:3",
  "11+3-4", "12-3*2", "7*2+1", "18:2-5", "6+5", "10-4",
  "8+3*2", "15-2*3", "5*4+1", "20:5+3", "9+6", "17-8",
  "2+2", "6*2", "12-2*4", "16:2+5", "18-4+1", "3*5-2", "10+6-3", "15:5+2",
  "9-3+6", "12-4*2", "5+3", "10-6", "8*2", "16:4", "7+2-1", "14-3+2",
  "6*3+1", "18:3-2", "4+5", "11-4", "3*4", "12:3", "10+4-5", "13-6+3",
  "7*2-1", "20:4+2", "9+2", "17-9", "6+6", "14-5", "8*1+2", "24:6-1",
  "5+7", "15-6", "3*2+1", "18:6+2"
];

const questions2 = [
  "5+3", "12-7", "4*3", "8:2", "9*2-4", "24:6+1", "14-6:2", "7*2+3",
  "16-3*4", "30:5-2", "6+8", "18-9", "9*2", "18:3", "10+5-3", "5+3*2",
  "11-4+6", "6*2-1", "27:9+4", "20-8:4", "7+4", "15-6", "8*2", "16:4",
  "6+3*2", "18-2*4", "4*4+2", "30:3-6", "10+5", "14-7",
  "3+4", "7*2", "9*2-5", "20:5+6", "21-4+3", "5*2+4", "12:4-1", "8+3*2",
  "14-7+5", "10-2*3", "6+3", "9-4", "5*2", "10:2", "11+6-2", "13-6+2",
  "7*2+3", "18:2-2", "6+4*2", "15-5+3", "3+5", "13-6", "4*5", "20:4",
  "12+2-6", "14-7*1", "6*3+2", "21:3-4", "5+6", "9-3",
  "7+2*3", "17-3*2", "3*6+1", "24:6+4", "8+5", "16-7",
  "4+2", "5*3", "14-3*3", "18:3+3", "20-5+1", "4*5-3", "9+6-2", "18:6+3",
  "10-5+7", "16-3*4", "7+3", "12-8", "6*2", "18:6", "5+4-2", "11-3+1",
  "8*2+1", "16:4-2", "6+7", "13-5", "4*3", "9:3", "13+2-7", "15-6+1",
  "5*3-2", "27:3+1", "8+4", "19-8", "7+5", "12-4", "6*1+3", "18:3-1",
  "4+6", "10-5", "2*5+2", "16:2+1"
];

const correctAnswers = [
  7, 7, 14, 3, 19, 11, 14, 20,
  6, 5, 14, 9, 16, 5, 11, 12,
  14, 10, 9, 16, 13, 5, 12, 3,
  13, 6, 16, 6, 16, 8,
  6, 16, 19, 11, 18, 15, 2, 14,
  13, 6, 9, 4, 21, 3, 13, 11,
  16, 5, 12, 14, 10, 6, 9, 3,
  10, 6, 15, 4, 11, 6,
  14, 9, 21, 7, 15, 13,
  4, 12, 4, 13, 15, 13, 13, 5,
  12, 4, 8, 4, 15, 13,
  19, 4, 9, 7, 12, 4, 9, 10,
  13, 11, 13, 7, 11, 9,
  10, 9, 7, 5,

  8, 5, 12, 4, 14, 5, 11, 17,
  4, 4, 14, 9, 12, 6, 12, 11,
  13, 11, 7, 18, 11, 9, 16, 4,
  12, 10, 18, 4, 15, 7,
  7, 14, 13, 10, 20, 14, 2, 14,
  12, 4, 9, 5, 10, 9, 17, 7,
  14, 7, 14, 13, 8, 7, 20, 5,
  8, 7, 20, 3, 11, 6,
  13, 11, 19, 8, 13, 9,
  6, 15, 5, 9, 16, 17, 13, 6,
  12, 4, 10, 4, 7, 9,
  17, 2, 13, 8, 12, 8, 6, 8,
  18, 4, 10, 5, 12, 9
];

    let results = {
      name: '',
      startTime: '',
      endTime: '',
      tests: []
    };

    let testIndex = 0;
    let startTime, interval, visibleTimer;

    function startTest() {
      const name = document.getElementById('nameInput').value.trim();
      if (!name) return alert("נא למלא שם");
      results.name = name;
      document.getElementById('intro').classList.add('hidden');
      testIndex = Math.random() < 0.5 ? 0 : 1;
      runTest();
    }

    function runTest() {
      const isVisible = (testIndex === 0);
      const questions = testIndex === 0 ? questions1 : questions2;
      const form = document.getElementById('testForm');
      form.innerHTML = '';
      document.getElementById('test').classList.remove('hidden');
      const timerEl = document.getElementById('timer');
      if (!isVisible) timerEl.classList.add('hidden');
      else timerEl.classList.remove('hidden');
      
      questions.forEach((q, i) => {
        form.innerHTML += `
          <div class="question">
            <label>${i + 1}. ${q}<br />
              <textarea name="q${i}"></textarea>
            </label>
          </div>`;
      });

      startTime = Date.now();
      let seconds = 300;
      visibleTimer = isVisible;

      interval = setInterval(() => {
        seconds--;
        if (visibleTimer) timerEl.textContent = `זמן שנותר: ${Math.floor(seconds/60)}:${(seconds%60).toString().padStart(2,'0')}`;
        if (seconds <= 0) {
          clearInterval(interval);
          submitTest();
        }
      }, 1000);
    }

    function submitTest(event) {
      if (event) event.preventDefault();
      clearInterval(interval);
      const formData = new FormData(document.getElementById('testForm'));
      const answers = [];
      const questions = testIndex === 0 ? questions1 : questions2;
      const offset = testIndex === 0 ? 0 : questions1.length;

      for (let i = 0; i < questions.length; i++) {
        const ans = formData.get(`q${i}`)?.trim() || '';
        const correct = parseFloat(correctAnswers[i + offset].toFixed(2));
        const given = parseFloat(ans);
        let status = 'לא הוגש';
        if (ans) {
          status = Math.abs(correct - given) < 0.1 ? 'נכון' : 'שגוי';
        }
        answers.push({ question: questions[i], answer: ans, correct, status });
      }

      results.tests.push({
        type: testIndex === 0 ? 'טיימר גלוי' : 'טיימר נסתר',
        start: new Date(startTime).toISOString(),
        end: new Date().toISOString(),
        answers
      });

      document.getElementById('test').classList.add('hidden');
      if (results.tests.length === 1) {
        testIndex = testIndex === 0 ? 1 : 0;
        document.getElementById('between').classList.remove('hidden');
      } else {
        document.getElementById('done').classList.remove('hidden');
      }
    }

    function startSecondTest() {
      document.getElementById('between').classList.add('hidden');
      runTest();
    }

function downloadResults() {
  let text = `תוצאות מבחן\n===============\n`;
  text += `שם הנבחנ/ת: ${results.name}\n`;
  text += `שעת התחלה: ${results.tests[0]?.start}\n`;
  text += `שעת סיום: ${results.tests[1]?.end}\n\n`;

  results.tests.forEach((test, index) => {
    text += `בחינה ${index + 1} (${test.type})\n`;
    text += `------------------------\n`;
    test.answers.forEach((ans, i) => {
      text += `${i + 1}. ${ans.question} => תשובה: ${ans.answer || '---'}, תקינות: ${ans.status}\n`;
    });
    text += `\n`;
  });

 text += `נא לשלוח קובץ זה לכתובת: tamarnnn@gmail.com\n`;

  const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = `תוצאות_${results.name || 'ללא_שם'}.txt`;
  link.click();

  alert("הקובץ ירד למחשב שלך. נא לשלוח אותו לכתובת tamar.research@gmail.com");
}


  </script>
</body>
</html>
